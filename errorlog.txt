    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Epoch 1/25:   4%|████▋                                                                                                                             | 160/4388 [00:01<00:42, 98.62it/s]Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Epoch 1/25:   4%|█████                                                                                                                             | 170/4388 [00:01<00:43, 97.38it/s]Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Epoch 1/25:   4%|█████▎                                                                                                                            | 180/4388 [00:01<00:43, 96.78it/s]Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Epoch 1/25:   4%|█████▋                                                                                                                            | 190/4388 [00:02<00:43, 96.88it/s]Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Epoch 1/25:   5%|█████▉                                                                                                                           | 202/4388 [00:02<00:40, 102.86it/s]Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Epoch 1/25:   5%|██████▎                                                                                                                          | 216/4388 [00:02<00:37, 111.14it/s]Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Error in batch: index 3 is out of bounds for dimension 1 with size 3
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 111, in forward
    target_locs[:, 3] * pos_mask,
    ~~~~~~~~~~~^^^^^^
IndexError: index 3 is out of bounds for dimension 1 with size 3
Epoch 1/25:   5%|██████▍                                                                                                                           | 218/4388 [00:02<00:44, 94.02it/s]
Traceback (most recent call last):
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/main.py", line 85, in <module>
    main() 
    ^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/main.py", line 80, in main
    train_custom_model(config)
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 224, in train_custom_model
    loss, loss_components = criterion(pred_locs, pred_conf, target_locs, target_conf)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/endoai/PHASE-1/Ajay/CrackedEngineer/Code/custom_train.py", line 66, in forward
    num_positives = target_conf.sum().item()
                    ^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

(CrackedEngineer) endoai@endoai:~/PHASE-1/Ajay/CrackedEngineer$ 
